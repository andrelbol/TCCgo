{% extends 'base.html' %}

{% block titleBlock %} TCC Go {% endblock %}

{% block content %}

<!-- <h1 class="text-center text-primary">Submissão de texto</h1> -->
  <div class="container" class="col-md-8 col-md-offset-2" ng-controller="textController">
    <div class="row">
      <div class="row" >
        <div class="col-md-8 col-md-offset-2" style="text-align: center">
          <h3>Submissão de Trabalho </h3>
          <br />
        </div>
      </div>
    </div>

    <form  method="post" action="{% url 'text:submit' %}" id="new-text-form" class="col-md-8 col-md-offset-2">
      {% csrf_token %}
    <!--  <div class="panel panel-default">
        <div class="panel-heading"> </div>
        <div class="panel-body"> -->
          <div class="row">
            <!--
            <div class="col-md-2">  <label for="text_title">Título: </label>  </div>
          -->
              <input  class="form-control" id="title_input" type="text" name="text_title" ng-model="text.title" required placeholder="Título">
          </div>
            <br />
          <div class="row">
            <!--
            <label for="text_content">Conteúdo: </label>
          -->
            <textarea class="form-control" id="content_input" name="text_content" style="resize: none; height: 300px" ng-model="text.content" required placeholder="Corpo do trabalho"> </textarea>
          </div>
            <br />
          <button class="btn btn-primary" ng-click="enviar()" style="float: right;"> enviar </button>
<!--
</div>
      </div> -->
    </form>
  </div>


{% endblock %}

{% block script %}
<script type="text/javascript">
var app = angular.module("myApp", []);

app.controller("textController", function ($scope, $http){
  $http.defaults.xsrfCookieName = 'csrftoken';
  $http.defaults.xsrfHeaderName = 'X-CSRFToken';

  $scope.text = {
    title: '',
    content: ''
  }

  $scope.send = function(){
    $http.post('/text/submit',$scope.text).then(
      function(data){
        var response = data.data;
        if(response['success'])
        {
          alert("Texto cadastrado com sucesso");
          window.location.reload();
        }
        //response.data resposta do servidor
      }
    );
  }


});

</script>
{% endblock %}
